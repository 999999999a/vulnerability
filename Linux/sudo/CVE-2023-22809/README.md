# CVE-2023-22809

## sudo Privilege escalation

Affected sudo versions: 1.8.0 to 1.9.12p1 

This script automates the exploitation of the CVE-2023-22809 vulnerability to 
gain a root shell. 

The script checks if the current user has access to run the `sudoedit` or 
`sudo -e` command for some file with root privileges. If it does it opens the 
sudoers file for the attacker to introduce the privilege escalation policy 
for the current user and get a root shell.

## 来源

[https://github.com/n3m1dotsys/CVE-2023-22809-sudoedit-privesc](https://github.com/n3m1dotsys/CVE-2023-22809-sudoedit-privesc)

## 影响范围

-   1.8.0 <=Sudo <= 1.9.12p1

## 简介

Sudo版本1.8.0 - 1.9.12p1中，Sudo 的 -e 选项（又名 sudoedit）功能对用户提供的环境变量（Sudo_EDITOR、VISUAL和EDITOR）中传递的额外参数处理不当，具有sudoedit访问权限的本地用户可以通过在要处理的文件列表中添加任意条目后编辑未经授权的文件来触发该漏洞，可能导致权限提升。如果指定的编辑器包含使保护机制失效的“--”参数（绕过sudoers策略），则易受该漏洞影响。
