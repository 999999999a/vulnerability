# CVE-2021-22555 pipe version

Using pipe-primitive  to exploit CVE-2021-22555, so no kaslr leak nor smap smep ktpi bypass is needed :)

(Q: What is pipe-primitive?  A: https://github.com/veritas501/pipe-primitive)

## 来源

[https://github.com/veritas501/CVE-2021-22555-PipeVersion](https://github.com/veritas501/CVE-2021-22555-PipeVersion)

## 简介

Linux 内核模块Netfilter中存在一处权限提升漏洞，在在64 位系统上为 32 位进程处理 setsockopt IPT_SO_SET_REPLACE（或 IP6T_SO_SET_REPLACE）时，如果内核选项CONFIG_USER_NS 、CONFIG_NET_NS被开启，则攻击者可以通过该漏洞实现权限提升，以及从docker、k8s容器中实施容器逃逸。

## 影响范围

Linux Kernel版本 >=2.6.19 (9fa492cdc160cd27ce1046cb36f47d3b2b1efa21)

Tested on both Linux 4.15 and Linux 5.8

![](assets/tested_on_4.15.png)

![](assets/tested_on_5.8.png)
