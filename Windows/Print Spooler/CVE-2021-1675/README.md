# CVE-2021-1675 / CVE-2021-34527

## 来源

[https://github.com/cube0x0/CVE-2021-1675](https://github.com/cube0x0/CVE-2021-1675)

## 漏洞简介

Microsoft Windows Print Spooler 服务未能限制对RpcAddPrinterDriverEx()函数的访问，该函数可能允许远程身份验证的攻击者以系统权限在易受攻击的系统上执行任意代码。该RpcAddPrinterDriverEx()函数用于在系统上安装打印机驱动程序。此函数的参数之一是DRIVER_CONTAINER对象，它包含有关添加的打印机将使用哪个驱动程序的信息。另一个参数，dwFileCopyFlags指定如何复制替换打印机驱动程序文件。攻击者可以利用任何经过身份验证的用户都可以调用RpcAddPrinterDriverEx()并指定位于远程服务器上的驱动程序文件这一事实。这会导致 Print Spooler 服务spoolsv.exe以 SYSTEM 权限执行任意 DLL 文件中的代码。

## 影响范围

-   Windows Server 2012 R2 (Server Core installation)

-   Windows Server 2012 R2

-   Windows Server 2012 (Server Core installation)

-   Windows Server 2012

-   Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)

-   Windows Server 2008 R2 for x64-based Systems Service Pack 1

-   Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation)

-   Windows Server 2008 for x64-based Systems Service Pack 2

-   Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation)

-   Windows Server 2008 for 32-bit Systems Service Pack 2

-   Windows RT 8.1

-   Windows 8.1 for x64-based systems

-   Windows 8.1 for 32-bit systems

-   Windows 7 for x64-based Systems Service Pack 1
-   
    Windows 7 for 32-bit Systems Service Pack 1

-   Windows Server 2016 (Server Core installation)

-   Windows Server 2016

-   Windows 10 Version 1607 for x64-based Systems

-   Windows 10 Version 1607 for 32-bit Systems

-   Windows 10 for x64-based Systems

-   Windows 10 for 32-bit Systems

-   Windows Server, version 20H2 (Server Core Installation)

-   Windows 10 Version 20H2 for ARM64-based Systems

-   Windows 10 Version 20H2 for 32-bit Systems

-   Windows 10 Version 20H2 for x64-based Systems

-   Windows Server, version 2004 (Server Core installation)

-   Windows 10 Version 2004 for x64-based Systems

-   Windows 10 Version 2004 for ARM64-based Systems

-   Windows 10 Version 2004 for 32-bit Systems

-   Windows 10 Version 21H1 for 32-bit Systems

-   Windows 10 Version 21H1 for ARM64-based Systems

-   Windows 10 Version 21H1 for x64-based Systems

-   Windows 10 Version 1909 for ARM64-based Systems

-   Windows 10 Version 1909 for x64-based Systems

-   Windows 10 Version 1909 for 32-bit Systems

-   Windows Server 2019 (Server Core installation)

-   Windows Server 2019

-   Windows 10 Version 1809 for ARM64-based Systems

-   Windows 10 Version 1809 for x64-based Systems

-   Windows 10 Version 1809 for 32-bit Systems
