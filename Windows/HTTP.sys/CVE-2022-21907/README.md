# CVE-2022-21907

## 描述

Windows HTTP协议栈远程代码执行漏洞

## 使用

```shell
# 安装第三方库
pip3 install -r requirements.txt
# 运行
python CVE-2022-21907.py
```

![image-20220120112628473](images/image-20220120112628473.png)

## 影响

Microsoft Windows HTTP 协议栈（HTTP.sys）存在远程代码执行漏洞，未经身份认证的 远程攻击者可通过向目标 Web 服务器发送特制的HTTP请求来利用此漏洞，可造成 windows IIS服务器系统蓝屏。

## 影响范围

- Windows
    - 10 Version 1809 for 32-bit Systems
    - 10 Version 1809 for x64-based Systems
    - 10 Version 1809 for ARM64-based Systems
    - 10 Version 21H1 for 32-bit Systems
    - 10 Version 21H1 for x64-based System
    - 10 Version 21H1 for ARM64-based Systems
    - 10 Version 20H2 for 32-bit Systems
    - 10 Version 20H2 for x64-based Systems
    - 10 Version 20H2 for ARM64-based Systems
    - 10 Version 21H2 for 32-bit Systems
    - 10 Version 21H2 for x64-based Systems
    - 10 Version 21H2 for ARM64-based Systems
    - 11 for x64-based Systems
    - 11 for ARM64-based Systems
- Windows Server
    - 2019
    - 2019 (Core installation)
    - 2022
    - 2022 (Server Core installation)
    - version 20H2 (Server Core Installation)
    

不受影响版本

- Windows 10 version 1909
- Windows Server 2019（默认配置不受影响）
- Windows 10 version 1809（默认配置不受影响）

## 漏洞修复

[CVE-2022-21907](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-21907)

## POC来源

[https://github.com/antx-code/CVE-2022-21907](https://github.com/antx-code/CVE-2022-21907)

